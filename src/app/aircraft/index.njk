{% extends "base-template.njk" %}

{% import "common/templates/includes/macros.njk" as m %}

{% block pageTitle %}
Manage aircraft | {{__('title')}}
{% endblock %}

{% block header %}
{% include "header-user.njk" %}
{% endblock %}

{% block beforeContent %}

  {% include "phase.njk" %}

{% endblock %}

{% block content %}

{% import "common/templates/includes/macros.njk" as m %}

<div class="govuk-grid-row">
	<div class="govuk-grid-column-two-thirds">

  {% if errors %}
  	{% include "common/templates/includes/errors.njk" %}
  {% endif %}

  {% if successMsg %}
    {% include "common/templates/includes/success-action.njk" %}
  {% endif %}

    <h1 class="govuk-heading-xl">{{__('title_aircraft')}}</h1>
    {% if cookie.getUserRole() != 'User' %}
    <p class="govuk-body-l">{{__('aircraft_caption')}}</p>
    {% endif %}
  </div>
  <div class="govuk-grid-column-full">
    
      <form id="aircraft" action="/aircraft" class="form-group" method="post" role="form" >
        <table class="govuk-table" id="SavedCraft">
          <thead class="govuk-table__head">
            <tr class="govuk-table__row">
              <th class="govuk-table__header" scope="col">{{__('field_aircraft_registration')}}</th>
              <th class="govuk-table__header" scope="col">{{__('field_aircraft_type')}}</th>
              <th class="govuk-table__header" scope="col">{{__('field_aircraft_base')}}</th>
              {% if cookie.getUserRole() != 'User' %}
              <th class="govuk-table__header" scope="col">{{__('table_action')}}</th>
              {% endif %}
            </tr>
          </thead>
          <tbody class="govuk-table__body">
          {% if savedCrafts.items | length %}
            {% for craft in savedCrafts.items %}
            <tr class="govuk-table__row">
              {% if cookie.getUserRole() != 'User' %}
              <td class="govuk-table__cell" scope="row"><button class="govuk-link btn-link" name="editCraft" value="{{ craft.craftId }}">{{ craft.registration }}</button></th>
              {% else %}
              <td class="govuk-table__cell">{{ craft.registration }}</td>
              {% endif %}
              <td class="govuk-table__cell">{{ craft.craftType }}</td>
              <td class="govuk-table__cell">{{ craft.craftBase | upper }}</td>
              {% if cookie.getUserRole() != 'User' %}
              <td class="govuk-table__cell"><button class="govuk-link btn-link" name="deleteCraft" value="{{ craft.craftId }}">{{__('table_delete')}}</button></th>
              {% endif %}
            </tr>
            {% endfor %}
          {% else %}
            <tr class="govuk-table__row">
              <td colspan="4"><p class="govuk-inset-text">{{__('aircraft_no_records')}}</p></td>
            </tr>
          {% endif %}
          </tbody>
        </table>
        {% if savedCrafts.items | length %}
        <nav>
          <script type="text/javascript">
            function transitionToPage(pageNumber) {
              nextPage=document.createElement('input');
              nextPage.type='hidden';
              nextPage.name='nextPage';
              nextPage.value=pageNumber;
              document.getElementById('aircraft').appendChild(nextPage);
              document.getElementById('aircraft').submit();
              return false;
            }
          </script>
          <div class="pagination__summary">Showing {{ pages.startItem }} &ndash; {{ pages.endItem }} of {{ pages.totalItems }} results {{ paginate }}</div>
          <ul class="pagination">
          {% if pages.currentPage > 1 %}
            <li class="pagination__item"><a class="pagination__link" href="#" onclick="transitionToPage({{ pages.previous }})" aria-label="Previous page"><span aria-hidden="true" role="presentation">&laquo;</span> Previous</a></li>
          {% else %}
            <li class="pagination__item"><a class="pagination__link current" href=""><span aria-hidden="true" role="presentation">&laquo;</span> Previous</a></li>
          {% endif %}
          {% for page in pages.items %}
            {% if page.number == pages.currentPage %}
              <li class="pagination__item"><a class="pagination__link current" href="" aria-current="true" aria-label="Page {{ page.number }}, current page">{{ page.number }}</a></li>
            {% else %}
              <li class="pagination__item"><a class="pagination__link" onclick="transitionToPage({{ page.number }})">{{ page.number }}</a></li>
            {% endif %}
          {% endfor%}
          {% if pages.hasNext %}
            {# <li class="pagination__item"><a class="pagination__link" href="{{ pages.next }} " aria-label="Next page">Next <span aria-hidden="true" role="presentation">&raquo;</span></a></li> #}
            <li class="pagination__item"><a class="pagination__link" href="#" onclick="transitionToPage({{ pages.next }})" aria-label="Next page">Next <span aria-hidden="true" role="presentation">&raquo;</span></a></li>
          {% else %}
            <li class="pagination__item"><a class="pagination__link current" href="">Next <span aria-hidden="true" role="presentation">&raquo;</span></a></li>
          {% endif %}
          </ul>
        </nav>
        {% endif %}
        <input type="hidden" name="_csrf" value="{{ csrfToken }}" />
      </form>
    
	</div>

  {% if cookie.getUserRole() != 'User' %}
	<div class="govuk-grid-column-full">
		<hr class="govuk-section-break govuk-section-break--visible govuk-section-break--xl govuk-!-margin-top-0">
	</div>

	<div class="govuk-grid-column-two-thirds">
		<h2 class="govuk-heading-l">{{__('aircraft_add')}}</h2>
		<p class="govuk-body-l">{{__('aircraft_add_caption')}}</p>
		<a href='/aircraft/add' class='govuk-button'>{{__('aircraft_add_button')}}</a>
	</div>

	<div class="govuk-grid-column-full">
		<hr class="govuk-section-break govuk-section-break--visible govuk-section-break--xl govuk-!-margin-top-0">
	</div>

  {% endif %}
</div>

{% endblock %}
